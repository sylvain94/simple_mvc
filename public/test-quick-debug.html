<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quick Debug</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .result { margin: 10px 0; padding: 15px; border: 1px solid #ccc; background: #f9f9f9; }
        .error { border-color: #ef4444; background: #fef2f2; color: #dc2626; }
        .success { border-color: #10b981; background: #f0fdf4; color: #059669; }
    </style>
</head>
<body>
    <h1>🚀 Quick Debug Test</h1>
    
    <div>
        <button onclick="testWithExactData()" style="padding: 10px 20px; background: #3b82f6; color: white; border: none; border-radius: 5px;">
            Test avec données exactes
        </button>
    </div>

    <div id="results"></div>

    <script>
        function testWithExactData() {
            const apiData = {
                "filePath": "/home/ansible/",
                "fileName": "mire_720p.ts",
                "multicastAddress": "232.0.0.2",
                "multicastPort": 6005,
                "name": "Mire 720p",
                "running": false,
                "enabled": true,
                "active": true
            };

            // Test de la logique fullPath
            const path = apiData.filePath || '';
            const name = apiData.fileName || '';
            
            let fullPathResult;
            if (path && name) {
                const normalizedPath = path.endsWith('/') ? path : path + '/';
                fullPathResult = `${normalizedPath}${name}`;
            } else if (path || name) {
                fullPathResult = path || name;
            } else {
                fullPathResult = 'No path specified';
            }

            // Test de la logique multicast
            let multicastResult;
            if (apiData.multicastAddress && apiData.multicastPort) {
                multicastResult = `${apiData.multicastAddress}:${apiData.multicastPort}`;
            } else {
                multicastResult = 'Not configured';
            }

            const results = document.getElementById('results');
            results.innerHTML = `
                <div class="result success">
                    <h3>✅ Test Results</h3>
                    <p><strong>Path:</strong> "${fullPathResult}"</p>
                    <p><strong>Multicast:</strong> "${multicastResult}"</p>
                    <hr>
                    <h4>Debug Info:</h4>
                    <p>filePath: "${apiData.filePath}" (length: ${apiData.filePath ? apiData.filePath.length : 'null'})</p>
                    <p>fileName: "${apiData.fileName}" (length: ${apiData.fileName ? apiData.fileName.length : 'null'})</p>
                    <p>path && name: ${!!(path && name)}</p>
                    <p>multicastAddress: "${apiData.multicastAddress}"</p>
                    <p>multicastPort: ${apiData.multicastPort}</p>
                    <p>multicast condition: ${!!(apiData.multicastAddress && apiData.multicastPort)}</p>
                </div>
            `;

            console.log('🔍 Quick test results:', {
                originalData: apiData,
                fullPath: fullPathResult,
                multicast: multicastResult
            });
        }

        // Test automatique au chargement
        window.onload = () => {
            console.log('🚀 Quick debug page loaded');
        };
    </script>
</body>
</html>
